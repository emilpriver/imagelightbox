!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(T,F,P){"use strict";var D=T("<div/>").attr("class","imagelightbox-loading").append(T("<div/>")),e=T("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=T("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),M=e.add(t),R=T("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),z=T("<a/>",{class:"imagelightbox-close"}),X=T("<div/>",{class:"imagelightbox-overlay"}),j=T("<a/>",{href:"#",class:"imagelightbox-navitem"}),L=T("<div/>",{class:"imagelightbox-nav"}),N=T("<div/>",{class:"imagelightbox-wrapper"}),K=T("body"),a=function(){var e=P.body||P.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},U=!1!==a(),Y=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},_="ontouchstart"in F,B=F.navigator.pointerEnabled||F.navigator.msPointerEnabled,H=function(e){if(_)return!0;if(!B||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},Q=!1!=!!(P.fullscreenEnabled||P.webkitFullscreenEnabled||P.mozFullScreenEnabled||P.msFullscreenEnabled);T.fn.imageLightbox=function(e){var c=T.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),a=function(){c.activity&&i(),c.arrows&&M.css("display","block")},r=function(){if(--h<0){if(!0===c.quitOnEnd)return C(),!1;h=p.length-1}d=p.eq(h),N.trigger("previous.ilb2"),k(1)},l=function(){if(++h>=p.length){if(!0===c.quitOnEnd)return C(),!1;h=0}d=p.eq(h),N.trigger("next.ilb2"),k(-1)},t=function(){N.append(D)},i=function(){T(".imagelightbox-loading").remove()},n=function(){N.append(X)},o=function(){z.appendTo(N).on("click.ilb7",function(){return C(),!1})},u=function(){R.html("&nbsp;"),T(d).data("ilb2-caption")?R.html(T(d).data("ilb2-caption")):0<T(d).find("img").length&&R.html(T(d).find("img").attr("alt"))},s=function(){if(p.length){for(var e=0;e<p.length;e++)L.append(j.clone());var t=L.children("a");t.eq(p.index(d)).addClass("active"),N.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(p.index(d)).addClass("active")}),N.append(L),L.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=T(this);if(p.eq(e.index()).attr("href")!==T(".imagelightbox").attr("src")){var t=p.eq(e.index());t.length&&(y=p.index(d),d=t,k(e.index()<y?-1:1))}e.addClass("active").siblings().removeClass("active")})}},g=function(){N.append(M),M.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),T(this).hasClass("imagelightbox-arrow-left")?r():l(),!1})},f="",p=T([]),d=T(),h=0,b=T(),m=0,v=0,x=0,w=!1,y=0,q=function(e){return"a"===T(e).prop("tagName").toLowerCase()&&new RegExp(".("+c.allowedTypes+")$","i").test(T(e).attr("href"))},E=function(){if(!b.length)return!0;var e=c.caption?R.outerHeight():0,o=T(F).width(),a=T(F).height()-e,r=Math.abs(1-c.gutter/100),l=new Image;l.src=b.attr("src"),l.onload=function(){if(m=l.width,v=l.height,o<m||a<v){var e=o/a<m/v?m/o:v/a;m/=e,v/=e}var t=v*r,i=m*r,n=(T(F).width()-i)/2;b.css({width:i+"px",height:t+"px",left:n+"px"})}},k=function(o){if(w)return!1;if(b.length){var e={opacity:0};U?Y(b,100*o-x+"px",c.animationSpeed/1e3):e.left=parseInt(b.css("left"))+100*o+"px",b.animate(e,c.animationSpeed,function(){S()}),x=0}w=!0,c.activity&&t(),c.caption&&u(),setTimeout(function(){var e=d.attr("href");b=T("<img id='"+c.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(b.appendTo(N),E(),b.css("opacity",0),U)Y(b,-100*o+"px",0),setTimeout(function(){Y(b,"0px",c.animationSpeed/1e3)},50);else{var t=parseInt(b.css("left"));e.left=t+"px",b.css("left",t-100*o+"px")}if(b.animate(e,c.animationSpeed,function(){w=!1,a()}),c.preloadNext){var i=p.eq(p.index(d)+1);i.length||(i=p.eq(0)),T("<img />").attr("src",i.attr("href"))}N.trigger("loaded.ilb2")}).on("error.ilb7",function(){a()});var t=0,i=0,n=0;b.on(B?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),c.quitOnImgClick?(C(),!1):!!H(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<m/2?r():l())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!H(e.originalEvent)||c.quitOnImgClick)return!0;U&&(n=parseInt(b.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!B&&"pointermove"===e.type||!H(e.originalEvent)||c.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,x=t-i,U?Y(b,-x+"px",0):b.css("left",n-x+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!H(e.originalEvent)||c.quitOnImgClick)return!0;50<Math.abs(x)?x<0?r():l():U?Y(b,"0px",c.animationSpeed/1e3):b.animate({left:n+"px"},c.animationSpeed/2)})},c.animationSpeed+100)},S=function(){if(!b.length)return!1;b.remove(),b=T()},O=function(e){if(w)return!1;w=!1,d=e,h=p.index(d),function(){c.arrows&&g(this),c.navigation&&s(),c.overlay&&n(),c.button&&o(),c.caption&&N.append(R)}(),K.append(N).addClass("imagelightbox-open"),N.trigger("start.ilb2"),k(0)},C=function(){if(N.trigger("quit.ilb2"),K.removeClass("imagelightbox-open"),!b.length)return!1;b.animate({opacity:0},c.animationSpeed,function(){S(),w=!1,p=T([]),N.remove().find("*").remove()})},I=function(t){t.on("click.ilb7",{set:f},function(e){e.preventDefault(),f=T(e.currentTarget).data("imagelightbox"),t.filter(function(){return T(this).data("imagelightbox")===f}).filter(function(){return q(T(this))}).each(function(){p=p.add(T(this))}),p.length<1?C():O(T(this))})};return T(F).on("resize.ilb7",E),T(P).ready(function(){c.quitOnDocClick&&T(P).on(_?"touchend.ilb7":"click.ilb7",function(e){b.length&&!T(e.target).is(b)&&(e.preventDefault(),C())}),c.fullscreen&&Q&&T(P).on("keydown.ilb7",function(e){if(!b.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=P.getElementById(c.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),P.exitFullscreen?P.exitFullscreen():P.mozCancelFullScreen?P.mozCancelFullScreen():P.webkitExitFullscreen&&P.webkitExitFullscreen())}),c.enableKeyboard&&T(P).on("keydown.ilb7",function(e){if(!b.length)return!0;-1<[27].indexOf(e.which)&&c.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),C()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),r()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),l())})}),T(P).off("click",c.selector),I(T(this)),this.addToImageLightbox=function(e){I(e)},this.loadPreviousImage=function(){r()},this.loadNextImage=function(){l()},this.quitImageLightbox=function(){return C(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):T(this).trigger("click.ilb7")},this}});