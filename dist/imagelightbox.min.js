!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(e,t,i){"use strict";var n=e("<div/>").attr("class","imagelightbox-loading").append(e("<div/>")),a=e("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),o=e("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),r=a.add(o),l=e("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),c=e("<a/>",{class:"imagelightbox-close"}),u=e("<div/>",{class:"imagelightbox-overlay"}),s=e("<a/>",{href:"#",class:"imagelightbox-navitem"}),f=e("<div/>",{class:"imagelightbox-nav"}),p=e("<div/>",{class:"imagelightbox-wrapper"}),g=e("body"),h=function(){var e=i.body||i.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},d=!1!==h(),b=function(e,t,i){var n={},a=h();n[a+"transform"]="translateX("+t+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s linear",e.css(n)},m="ontouchstart"in t,v=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,x=function(e){if(m)return!0;if(!v||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},w=!1!=!!(i.fullscreenEnabled||i.webkitFullscreenEnabled||i.mozFullScreenEnabled||i.msFullscreenEnabled);e.fn.imageLightbox=function(a){var o=e.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},a),h=function(){o.activity&&k(),o.arrows&&r.css("display","block")},y=function(){var e=P.index(D)-1;if(e<0){if(!0===o.quitOnEnd)return B(),!1;e=P.length-1}D=P.eq(e),p.trigger("previous.ilb2"),U(1)},E=function(){var e=P.index(D)+1;if(e>=P.length){if(!0===o.quitOnEnd)return B(),!1;e=0}D=P.eq(e),p.trigger("next.ilb2"),U(-1)},q=function(){p.append(n)},k=function(){e(".imagelightbox-loading").remove()},O=function(){p.append(u)},S=function(){c.appendTo(p).on("click.ilb7",function(){return B(),!1})},C=function(){l.html("&nbsp;"),e(D).data("ilb2-caption")?l.html(e(D).data("ilb2-caption")):e(D).find("img").length>0&&l.html(e(D).find("img").attr("alt"))},I=function(){if(P.length){for(var t=0;t<P.length;t++)f.append(s.clone());var i=f.children("a");i.eq(P.index(D)).addClass("active"),p.on("previous.ilb2 next.ilb2",function(){i.removeClass("active").eq(P.index(D)).addClass("active")}),p.append(f),f.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=e(this);if(P.eq(t.index()).attr("href")!==e(".imagelightbox").attr("src")){var i=P.eq(t.index());i.length&&(L=P.index(D),D=i,U(t.index()<L?-1:1))}t.addClass("active").siblings().removeClass("active")})}},T=function(){p.append(r),r.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),e(this).hasClass("imagelightbox-arrow-left")?y():E(),!1})},F="",P=e([]),D=e(),M=e(),R=0,z=0,j=0,X=!1,L=0,N=function(e){var t=o.allowedTypes;if(!/^(?!\|)[\w|]+(?!\|)$/.test(t))return!1;var n=function(e){var t,n,a,o=i.createElement("a"),r={};for(o.href=e,t=o.search.replace(/^\?/,"").split("&"),a=0;a<t.length;a++)n=t[a].split("="),r[n[0]]=n[1];return{protocol:o.protocol,host:o.host,hostname:o.hostname,port:o.port,pathname:o.pathname,search:o.search,searchObject:r,hash:o.hash}}(e.attr("href")).pathname;return new RegExp(t,"i").test(n)},K=function(){if(!M.length)return!0;var i=o.caption?l.outerHeight():0,n=e(t).width(),a=e(t).height()-i,r=Math.abs(1-o.gutter/100),c=new Image;c.src=M.attr("src"),c.onload=function(){if(R=c.width,z=c.height,R>n||z>a){var i=R/z>n/a?R/n:z/a;R/=i,z/=i}var o=z*r,l=R*r,u=(e(t).width()-l)/2;M.css({width:l+"px",height:o+"px",left:u+"px"})}},U=function(t){if(X)return!1;if(M.length){var i={opacity:0};d?b(M,100*t-j+"px",o.animationSpeed/1e3):i.left=parseInt(M.css("left"))+100*t+"px",M.animate(i,o.animationSpeed,function(){Y()}),j=0}X=!0,o.activity&&q(),o.caption&&C(),setTimeout(function(){var i=D.attr("href");M=e("<img id='"+o.id+"' />").attr("src",i).on("load.ilb7",function(){var i={opacity:1};if(M.appendTo(p),K(),M.css("opacity",0),d)b(M,-100*t+"px",0),setTimeout(function(){b(M,"0px",o.animationSpeed/1e3)},50);else{var n=parseInt(M.css("left"));i.left=n+"px",M.css("left",n-100*t+"px")}if(M.animate(i,o.animationSpeed,function(){X=!1,h()}),o.preloadNext){var a=P.eq(P.index(D)+1);a.length||(a=P.eq(0)),e("<img />").attr("src",a.attr("href"))}p.trigger("loaded.ilb2")}).on("error.ilb7",function(){h()});var n=0,a=0,r=0;M.on(v?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){if(e.preventDefault(),o.quitOnImgClick)return B(),!1;if(x(e.originalEvent))return!0;var t=(e.pageX||e.originalEvent.pageX)-e.target.offsetLeft;R/2>t?y():E()}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!x(e.originalEvent)||o.quitOnImgClick)return!0;d&&(r=parseInt(M.css("left"))),n=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!v&&"pointermove"===e.type||!x(e.originalEvent)||o.quitOnImgClick)return!0;e.preventDefault(),a=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,j=n-a,d?b(M,-j+"px",0):M.css("left",r-j+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!x(e.originalEvent)||o.quitOnImgClick)return!0;Math.abs(j)>50?j<0?y():E():d?b(M,"0px",o.animationSpeed/1e3):M.animate({left:r+"px"},o.animationSpeed/2)})},o.animationSpeed+100)},Y=function(){if(!M.length)return!1;M.remove(),M=e()},_=function(e){if(X)return!1;X=!1,D=e,function(){o.arrows&&T(this),o.navigation&&I(),o.overlay&&O(),o.button&&S(),o.caption&&p.append(l)}(),g.append(p).addClass("imagelightbox-open"),p.trigger("start.ilb2"),U(0)},B=function(){if(p.trigger("quit.ilb2"),g.removeClass("imagelightbox-open"),!M.length)return!1;M.animate({opacity:0},o.animationSpeed,function(){Y(),X=!1,P=e([]),p.remove().find("*").remove()})},H=function(t){t.on("click.ilb7",{set:F},function(i){i.preventDefault(),F=e(i.currentTarget).data("imagelightbox"),t.filter(function(){return e(this).data("imagelightbox")===F}).filter(function(){return N(e(this))}).each(function(){P=P.add(e(this))}),P.length<1?B():_(e(this))})};return e(t).on("resize.ilb7",K),e(i).ready(function(){o.quitOnDocClick&&e(i).on(m?"touchend.ilb7":"click.ilb7",function(t){M.length&&!e(t.target).is(M)&&(t.preventDefault(),B())}),o.fullscreen&&w&&e(i).on("keydown.ilb7",function(e){if(!M.length)return!0;var t;[9,32,38,40].indexOf(e.which)>-1&&(e.stopPropagation(),e.preventDefault()),[13].indexOf(e.which)>-1&&(e.stopPropagation(),e.preventDefault(),(t=i.getElementById(o.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),i.exitFullscreen?i.exitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen())}),o.enableKeyboard&&e(i).on("keydown.ilb7",function(e){if(!M.length)return!0;[27].indexOf(e.which)>-1&&o.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),B()),[37].indexOf(e.which)>-1&&(e.stopPropagation(),e.preventDefault(),y()),[39].indexOf(e.which)>-1&&(e.stopPropagation(),e.preventDefault(),E())})}),e(i).off("click",o.selector),H(e(this)),this.addToImageLightbox=function(e){H(e)},this.loadPreviousImage=function(){y()},this.loadNextImage=function(){E()},this.quitImageLightbox=function(){return B(),this},this.startImageLightbox=function(t){t?t.trigger("click.ilb7"):e(this).trigger("click.ilb7")},this}});