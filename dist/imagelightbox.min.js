!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(D,L,M){"use strict";var z=D("<div/>").attr("class","imagelightbox-loading").append(D("<div/>")),e=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),X=e.add(t),j=D("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),N=D("<a/>",{class:"imagelightbox-close"}),U=D("<div/>",{class:"imagelightbox-overlay"}),K=D("<a/>",{href:"#",class:"imagelightbox-navitem"}),Y=D("<div/>",{class:"imagelightbox-nav"}),_=D("<div/>",{class:"imagelightbox-wrapper"}),$=D("body"),a=function(){var e=M.body||M.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},B=!1!==a(),H=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},Q="ontouchstart"in L,W=L.navigator.pointerEnabled||L.navigator.msPointerEnabled,A=function(e){if(Q)return!0;if(!W||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},G=!1!=!!(M.fullscreenEnabled||M.webkitFullscreenEnabled||M.mozFullScreenEnabled||M.msFullscreenEnabled);D.fn.imageLightbox=function(e){var t,i,n="",a=D([]),r=D(),o=-1,l=D(this),c=D(),u=0,s=0,g=0,f=!1,p=0,d=D.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),h=function(){d.activity&&w(),d.arrows&&X.css("display","block")},b=function(){var e=M.location.search,t="imageLightboxIndex="+o,i="?"+t;if(e){var n=new RegExp("([?&])imageLightboxIndex=[^&]*");i=null!==e.match(n)?e.replace(n,"$1"+t):e+"&"+t}L.history.pushState({imageLightboxIndex:o},"",i)},m=function(){if(--o<0){if(!0===d.quitOnEnd)return P(),!1;o=a.length-1}r=a.eq(o),b(),_.trigger("previous.ilb2"),C(1)},v=function(){if(++o>=a.length){if(!0===d.quitOnEnd)return P(),!1;o=0}b(),r=a.eq(o),_.trigger("next.ilb2"),C(-1)},x=function(){_.append(z)},w=function(){D(".imagelightbox-loading").remove()},E=function(){_.append(U)},y=function(){N.appendTo(_).on("click.ilb7",function(){return P(),!1})},q=function(){j.html("&nbsp;"),D(r).data("ilb2-caption")?j.html(D(r).data("ilb2-caption")):0<D(r).find("img").length&&j.html(D(r).find("img").attr("alt"))},k=function(){if(a.length){for(var e=0;e<a.length;e++)Y.append(K.clone());var t=Y.children("a");t.eq(a.index(r)).addClass("active"),_.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(a.index(r)).addClass("active")}),_.append(Y),Y.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=D(this);if(a.eq(e.index()).attr("href")!==D(".imagelightbox").attr("src")){var t=a.eq(e.index());t.length&&(p=a.index(r),r=t,C(e.index()<p?-1:1))}e.addClass("active").siblings().removeClass("active")})}},I=function(){_.append(X),X.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),D(this).hasClass("imagelightbox-arrow-left")?m():v(),!1})},S=function(e){return"a"===D(e).prop("tagName").toLowerCase()&&new RegExp(".("+d.allowedTypes+")$","i").test(D(e).attr("href"))},O=function(){if(!c.length)return!0;var e=d.caption?j.outerHeight():0,o=D(L).width(),a=D(L).height()-e,r=Math.abs(1-d.gutter/100),l=new Image;l.src=c.attr("src"),l.onload=function(){if(u=l.width,s=l.height,o<u||a<s){var e=o/a<u/s?u/o:s/a;u/=e,s/=e}var t=s*r,i=u*r,n=(D(L).width()-i)/2;c.css({width:i+"px",height:t+"px",left:n+"px"})}},C=function(o){if(f)return!1;if(c.length){var e={opacity:0};B?H(c,100*o-g+"px",d.animationSpeed/1e3):e.left=parseInt(c.css("left"))+100*o+"px",c.animate(e,d.animationSpeed,function(){T()}),g=0}f=!0,d.activity&&x(),d.caption&&q(),setTimeout(function(){var e=r.attr("href"),t=0,i=0,n=0;c=D("<img id='"+d.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(c.appendTo(_),O(),c.css("opacity",0),B)H(c,-100*o+"px",0),setTimeout(function(){H(c,"0px",d.animationSpeed/1e3)},50);else{var t=parseInt(c.css("left"));e.left=t+"px",c.css("left",t-100*o+"px")}if(c.animate(e,d.animationSpeed,function(){f=!1,h()}),d.preloadNext){var i=a.eq(a.index(r)+1);i.length||(i=a.eq(0)),D("<img />").attr("src",i.attr("href"))}_.trigger("loaded.ilb2")}).on("error.ilb7",function(){h()}).on(W?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),d.quitOnImgClick?(P(),!1):!!A(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<u/2?m():v())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!A(e.originalEvent)||d.quitOnImgClick)return!0;B&&(n=parseInt(c.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!W&&"pointermove"===e.type||!A(e.originalEvent)||d.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,g=t-i,B?H(c,-g+"px",0):c.css("left",n-g+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!A(e.originalEvent)||d.quitOnImgClick)return!0;50<Math.abs(g)?g<0?m():v():B?H(c,"0px",d.animationSpeed/1e3):c.animate({left:n+"px"},d.animationSpeed/2)})},d.animationSpeed+100)},T=function(){if(!c.length)return!1;c.remove(),c=D()},F=function(e,t){if(f)return!1;f=!1,r=e,o=a.index(r),t||b(),function(){d.arrows&&I(this),d.navigation&&k(),d.overlay&&E(),d.button&&y(),d.caption&&_.append(j)}(),$.append(_).addClass("imagelightbox-open"),_.trigger("start.ilb2"),C(0)},P=function(e){if(o=-1,e||function(){var e=M.location.search;if(e){var t=new RegExp("[?]imageLightboxIndex=[^&]*"),i=new RegExp("&imageLightboxIndex=[^&]*"),n=e.replace(t,"?");n=n.replace(i,""),L.history.pushState({},"",n)}}(),_.trigger("quit.ilb2"),$.removeClass("imagelightbox-open"),!c.length)return!1;c.animate({opacity:0},d.animationSpeed,function(){T(),f=!1,a=D([]),_.remove().find("*").remove()})},R=function(t){t.on("click.ilb7",{set:n},function(e){e.preventDefault(),n=D(e.currentTarget).data("imagelightbox"),t.filter(function(){return D(this).data("imagelightbox")===n}).filter(function(){return S(D(this))}).each(function(){a=a.add(D(this))}),a.length<1?P():F(D(this))})};return D(L).on("resize.ilb7",O).on("popstate",function(e){var t=e.originalEvent.state;if(t){var i=t.imageLightboxIndex;if(i)if(o<0)F(D((a=l)[i]),!0);else{var n=1;o<i&&(n=-1),r=D(a[i]),o=i,C(n)}else P(!0)}else P()}),D(M).ready(function(){d.quitOnDocClick&&D(M).on(Q?"touchend.ilb7":"click.ilb7",function(e){c.length&&!D(e.target).is(c)&&(e.preventDefault(),P())}),d.fullscreen&&G&&D(M).on("keydown.ilb7",function(e){if(!c.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=M.getElementById(d.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),M.exitFullscreen?M.exitFullscreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen&&M.webkitExitFullscreen())}),d.enableKeyboard&&D(M).on("keydown.ilb7",function(e){if(!c.length)return!0;-1<[27].indexOf(e.which)&&d.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),P()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),m()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),v())})}),D(M).off("click",d.selector),R(D(this)),t=D(this),(i=new RegExp("[?&]imageLightboxIndex(=([^&#]*)|&|#|$)").exec(M.location.search))&&i[2]&&(o=decodeURIComponent(i[2].replace(/\+/g," ")),F(D((a=t)[o]))),this.addToImageLightbox=function(e){R(e)},this.loadPreviousImage=function(){m()},this.loadNextImage=function(){v()},this.quitImageLightbox=function(){return P(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):D(this).trigger("click.ilb7")},this}});