!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(I,T,F){"use strict";var P=I("<div/>").attr("class","imagelightbox-loading").append(I("<div/>")),e=I("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=I("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),D=e.add(t),M=I("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),R=I("<a/>",{class:"imagelightbox-close"}),z=I("<div/>",{class:"imagelightbox-overlay"}),j=I("<a/>",{href:"#",class:"imagelightbox-navitem"}),X=I("<div/>",{class:"imagelightbox-nav"}),L=I("<div/>",{class:"imagelightbox-wrapper"}),N=I("body"),a=function(){var e=F.body||F.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},K=!1!==a(),U=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},Y="ontouchstart"in T,_=T.navigator.pointerEnabled||T.navigator.msPointerEnabled,B=function(e){if(Y)return!0;if(!_||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},H=!1!=!!(F.fullscreenEnabled||F.webkitFullscreenEnabled||F.mozFullScreenEnabled||F.msFullscreenEnabled);I.fn.imageLightbox=function(e){var c=I.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),a=function(){c.activity&&i(),c.arrows&&D.css("display","block")},r=function(){var e=g.index(d)-1;if(e<0){if(!0===c.quitOnEnd)return S(),!1;e=g.length-1}d=g.eq(e),L.trigger("previous.ilb2"),q(1)},l=function(){var e=g.index(d)+1;if(e>=g.length){if(!0===c.quitOnEnd)return S(),!1;e=0}d=g.eq(e),L.trigger("next.ilb2"),q(-1)},t=function(){L.append(P)},i=function(){I(".imagelightbox-loading").remove()},n=function(){L.append(z)},o=function(){R.appendTo(L).on("click.ilb7",function(){return S(),!1})},s=function(){M.html("&nbsp;"),I(d).data("ilb2-caption")?M.html(I(d).data("ilb2-caption")):0<I(d).find("img").length&&M.html(I(d).find("img").attr("alt"))},u=function(){if(g.length){for(var e=0;e<g.length;e++)X.append(j.clone());var t=X.children("a");t.eq(g.index(d)).addClass("active"),L.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(g.index(d)).addClass("active")}),L.append(X),X.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=I(this);if(g.eq(e.index()).attr("href")!==I(".imagelightbox").attr("src")){var t=g.eq(e.index());t.length&&(w=g.index(d),d=t,q(e.index()<w?-1:1))}e.addClass("active").siblings().removeClass("active")})}},f=function(){L.append(D),D.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),I(this).hasClass("imagelightbox-arrow-left")?r():l(),!1})},p="",g=I([]),d=I(),h=I(),b=0,m=0,v=0,x=!1,w=0,y=function(e){var t=c.allowedTypes;if(!/^(?!\|)[\w|]+(?!\|)$/.test(t))return!1;var i=function(e){var t,i,n,o=F.createElement("a"),a={};for(o.href=e,t=o.search.replace(/^\?/,"").split("&"),n=0;n<t.length;n++)i=t[n].split("="),a[i[0]]=i[1];return{protocol:o.protocol,host:o.host,hostname:o.hostname,port:o.port,pathname:o.pathname,search:o.search,searchObject:a,hash:o.hash}}(e.attr("href")).pathname;return new RegExp(t,"i").test(i)},E=function(){if(!h.length)return!0;var e=c.caption?M.outerHeight():0,o=I(T).width(),a=I(T).height()-e,r=Math.abs(1-c.gutter/100),l=new Image;l.src=h.attr("src"),l.onload=function(){if(b=l.width,m=l.height,o<b||a<m){var e=o/a<b/m?b/o:m/a;b/=e,m/=e}var t=m*r,i=b*r,n=(I(T).width()-i)/2;h.css({width:i+"px",height:t+"px",left:n+"px"})}},q=function(o){if(x)return!1;if(h.length){var e={opacity:0};K?U(h,100*o-v+"px",c.animationSpeed/1e3):e.left=parseInt(h.css("left"))+100*o+"px",h.animate(e,c.animationSpeed,function(){k()}),v=0}x=!0,c.activity&&t(),c.caption&&s(),setTimeout(function(){var e=d.attr("href");h=I("<img id='"+c.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(h.appendTo(L),E(),h.css("opacity",0),K)U(h,-100*o+"px",0),setTimeout(function(){U(h,"0px",c.animationSpeed/1e3)},50);else{var t=parseInt(h.css("left"));e.left=t+"px",h.css("left",t-100*o+"px")}if(h.animate(e,c.animationSpeed,function(){x=!1,a()}),c.preloadNext){var i=g.eq(g.index(d)+1);i.length||(i=g.eq(0)),I("<img />").attr("src",i.attr("href"))}L.trigger("loaded.ilb2")}).on("error.ilb7",function(){a()});var t=0,i=0,n=0;h.on(_?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),c.quitOnImgClick?(S(),!1):!!B(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<b/2?r():l())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!B(e.originalEvent)||c.quitOnImgClick)return!0;K&&(n=parseInt(h.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!_&&"pointermove"===e.type||!B(e.originalEvent)||c.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,v=t-i,K?U(h,-v+"px",0):h.css("left",n-v+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!B(e.originalEvent)||c.quitOnImgClick)return!0;50<Math.abs(v)?v<0?r():l():K?U(h,"0px",c.animationSpeed/1e3):h.animate({left:n+"px"},c.animationSpeed/2)})},c.animationSpeed+100)},k=function(){if(!h.length)return!1;h.remove(),h=I()},O=function(e){if(x)return!1;x=!1,d=e,function(){c.arrows&&f(this),c.navigation&&u(),c.overlay&&n(),c.button&&o(),c.caption&&L.append(M)}(),N.append(L).addClass("imagelightbox-open"),L.trigger("start.ilb2"),q(0)},S=function(){if(L.trigger("quit.ilb2"),N.removeClass("imagelightbox-open"),!h.length)return!1;h.animate({opacity:0},c.animationSpeed,function(){k(),x=!1,g=I([]),L.remove().find("*").remove()})},C=function(t){t.on("click.ilb7",{set:p},function(e){e.preventDefault(),p=I(e.currentTarget).data("imagelightbox"),t.filter(function(){return I(this).data("imagelightbox")===p}).filter(function(){return y(I(this))}).each(function(){g=g.add(I(this))}),g.length<1?S():O(I(this))})};return I(T).on("resize.ilb7",E),I(F).ready(function(){c.quitOnDocClick&&I(F).on(Y?"touchend.ilb7":"click.ilb7",function(e){h.length&&!I(e.target).is(h)&&(e.preventDefault(),S())}),c.fullscreen&&H&&I(F).on("keydown.ilb7",function(e){if(!h.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=F.getElementById(c.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),F.exitFullscreen?F.exitFullscreen():F.mozCancelFullScreen?F.mozCancelFullScreen():F.webkitExitFullscreen&&F.webkitExitFullscreen())}),c.enableKeyboard&&I(F).on("keydown.ilb7",function(e){if(!h.length)return!0;-1<[27].indexOf(e.which)&&c.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),S()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),r()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),l())})}),I(F).off("click",c.selector),C(I(this)),this.addToImageLightbox=function(e){C(e)},this.loadPreviousImage=function(){r()},this.loadNextImage=function(){l()},this.quitImageLightbox=function(){return S(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):I(this).trigger("click.ilb7")},this}});