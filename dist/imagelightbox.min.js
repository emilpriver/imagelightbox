!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(P,R,D){"use strict";var L=P("<div/>").attr("class","imagelightbox-loading").append(P("<div/>")),e=P("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=P("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),M=e.add(t),z=P("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),X=P("<a/>",{class:"imagelightbox-close"}),j=P("<div/>",{class:"imagelightbox-overlay"}),N=P("<a/>",{href:"#",class:"imagelightbox-navitem"}),U=P("<div/>",{class:"imagelightbox-nav"}),K=P("<div/>",{class:"imagelightbox-wrapper"}),Y=P("body"),a=function(){var e=D.body||D.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},_=!1!==a(),$=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},B="ontouchstart"in R,H=R.navigator.pointerEnabled||R.navigator.msPointerEnabled,Q=function(e){if(B)return!0;if(!H||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},W=!1!=!!(D.fullscreenEnabled||D.webkitFullscreenEnabled||D.mozFullScreenEnabled||D.msFullscreenEnabled),A=!(!R.history||!history.pushState);P.fn.imageLightbox=function(e){var i="",r=P([]),l=P(),c=-1,s=P(this),u=P(),g=0,f=0,a=0,p=!1,n=0,d=P.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),h=function(){d.activity&&v(),d.arrows&&M.css("display","block")},o=function(){if(A&&d.history){var e=r[c].dataset.ilb2Id;e||(e=c);var t=D.location.search,i="imageLightboxIndex="+e,n="?"+i;if(t){var o=new RegExp("([?&])imageLightboxIndex=[^&]*");n=null!==t.match(o)?t.replace(o,"$1"+i):t+"&"+i}R.history.pushState({imageLightboxIndex:e},"",n)}},b=function(){if(--c<0){if(!0===d.quitOnEnd)return T(),!1;c=r.length-1}l=r.eq(c),o(),K.trigger("previous.ilb2"),S(1)},m=function(){if(++c>=r.length){if(!0===d.quitOnEnd)return T(),!1;c=0}o(),l=r.eq(c),K.trigger("next.ilb2"),S(-1)},t=function(){K.append(L)},v=function(){P(".imagelightbox-loading").remove()},x=function(){K.append(j)},y=function(){X.appendTo(K).on("click.ilb7",function(){return T(),!1})},w=function(){z.html("&nbsp;"),P(l).data("ilb2-caption")?z.html(P(l).data("ilb2-caption")):0<P(l).find("img").length&&z.html(P(l).find("img").attr("alt"))},E=function(){if(r.length){for(var e=0;e<r.length;e++)U.append(N.clone());var t=U.children("a");t.eq(r.index(l)).addClass("active"),K.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(r.index(l)).addClass("active")}),K.append(U),U.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=P(this);if(r.eq(e.index()).attr("href")!==P(".imagelightbox").attr("src")){var t=r.eq(e.index());t.length&&(n=r.index(l),l=t,S(e.index()<n?-1:1))}e.addClass("active").siblings().removeClass("active")})}},q=function(){K.append(M),M.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),P(this).hasClass("imagelightbox-arrow-left")?b():m(),!1})},k=function(e){return"a"===P(e).prop("tagName").toLowerCase()&&new RegExp(".("+d.allowedTypes+")$","i").test(P(e).attr("href"))},I=function(){if(!u.length)return!0;var e=d.caption?z.outerHeight():0,o=P(R).width(),a=P(R).height()-e,r=Math.abs(1-d.gutter/100),l=new Image;l.src=u.attr("src"),l.onload=function(){if(g=l.width,f=l.height,o<g||a<f){var e=o/a<g/f?g/o:f/a;g/=e,f/=e}var t=f*r,i=g*r,n=(P(R).width()-i)/2;u.css({width:i+"px",height:t+"px",left:n+"px"})}},S=function(o){if(p)return!1;if(u.length){var e={opacity:0};_?$(u,100*o-a+"px",d.animationSpeed/1e3):e.left=parseInt(u.css("left"))+100*o+"px",u.animate(e,d.animationSpeed,function(){O()}),a=0}p=!0,d.activity&&t(),d.caption&&w(),setTimeout(function(){var e=l.attr("href"),t=0,i=0,n=0;u=P("<img id='"+d.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(u.appendTo(K),I(),u.css("opacity",0),_)$(u,-100*o+"px",0),setTimeout(function(){$(u,"0px",d.animationSpeed/1e3)},50);else{var t=parseInt(u.css("left"));e.left=t+"px",u.css("left",t-100*o+"px")}if(u.animate(e,d.animationSpeed,function(){p=!1,h()}),d.preloadNext){var i=r.eq(r.index(l)+1);i.length||(i=r.eq(0)),P("<img />").attr("src",i.attr("href"))}K.trigger("loaded.ilb2")}).on("error.ilb7",function(){h()}).on(H?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),d.quitOnImgClick?(T(),!1):!!Q(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<g/2?b():m())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!Q(e.originalEvent)||d.quitOnImgClick)return!0;_&&(n=parseInt(u.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!H&&"pointermove"===e.type||!Q(e.originalEvent)||d.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,a=t-i,_?$(u,-a+"px",0):u.css("left",n-a+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!Q(e.originalEvent)||d.quitOnImgClick)return!0;50<Math.abs(a)?a<0?b():m():_?$(u,"0px",d.animationSpeed/1e3):u.animate({left:n+"px"},d.animationSpeed/2)})},d.animationSpeed+100)},O=function(){if(!u.length)return!1;u.remove(),u=P()},C=function(e,t){if(p)return!1;p=!1,l=e,c=r.index(l),t||o(),function(){d.arrows&&q(this),d.navigation&&E(),d.overlay&&x(),d.button&&y(),d.caption&&K.append(z)}(),Y.append(K).addClass("imagelightbox-open"),K.trigger("start.ilb2"),S(0)},T=function(e){if(c=-1,e||function(){if(A&&d.history){var e=D.location.search;if(e){var t=new RegExp("[?]imageLightboxIndex=[^&]*"),i=new RegExp("&imageLightboxIndex=[^&]*"),n=e.replace(t,"?");n=n.replace(i,""),R.history.pushState({},"",n)}}}(),K.trigger("quit.ilb2"),Y.removeClass("imagelightbox-open"),!u.length)return!1;u.animate({opacity:0},d.animationSpeed,function(){O(),p=!1,r=P([]),K.remove().find("*").remove()})},F=function(t){t.on("click.ilb7",{set:i},function(e){e.preventDefault(),i=P(e.currentTarget).data("imagelightbox"),t.filter(function(){return P(this).data("imagelightbox")===i}).filter(function(){return k(P(this))}).each(function(){r=r.add(P(this))}),r.length<1?T():C(P(this))})};return P(R).on("resize.ilb7",I),A&&d.history&&P(R).on("popstate",function(e){var t=e.originalEvent.state;if(t){var i=t.imageLightboxIndex;if(void 0!==i){var n=s.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var o=s.index(n);else n=P(s[o=i]);if(c<0)return r=s,void C(n,!0);var a=1;c<o&&(a=-1),l=n,c=o,S(a)}else T(!0)}else T(!0)}),P(D).ready(function(){d.quitOnDocClick&&P(D).on(B?"touchend.ilb7":"click.ilb7",function(e){u.length&&!P(e.target).is(u)&&(e.preventDefault(),T())}),d.fullscreen&&W&&P(D).on("keydown.ilb7",function(e){if(!u.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=D.getElementById(d.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),D.exitFullscreen?D.exitFullscreen():D.mozCancelFullScreen?D.mozCancelFullScreen():D.webkitExitFullscreen&&D.webkitExitFullscreen())}),d.enableKeyboard&&P(D).on("keydown.ilb7",function(e){if(!u.length)return!0;-1<[27].indexOf(e.which)&&d.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),T()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),b()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),m())})}),P(D).off("click",d.selector),F(s),function(){if(A&&d.history){var e=new RegExp("[?&]imageLightboxIndex(=([^&#]*)|&|#|$)").exec(D.location.search);if(e&&e[2]){r=s;var t=decodeURIComponent(e[2].replace(/\+/g," ")),i=r.filter('[data-ilb2-id="'+t+'"]');0<i.length?c=r.index(i):i=P(r[c=t]),C(i,!0)}}}(),this.addToImageLightbox=function(e){F(e)},this.loadPreviousImage=function(){b()},this.loadNextImage=function(){m()},this.quitImageLightbox=function(){return T(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):P(this).trigger("click.ilb7")},this}});