!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(F,P,D){"use strict";var M=F("<div/>").attr("class","imagelightbox-loading").append(F("<div/>")),e=F("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=F("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),R=e.add(t),L=F("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),z=F("<a/>",{class:"imagelightbox-close"}),X=F("<div/>",{class:"imagelightbox-overlay"}),j=F("<a/>",{href:"#",class:"imagelightbox-navitem"}),N=F("<div/>",{class:"imagelightbox-nav"}),K=F("<div/>",{class:"imagelightbox-wrapper"}),U=F("body"),a=function(){var e=D.body||D.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},Y=!1!==a(),_=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},$="ontouchstart"in P,B=P.navigator.pointerEnabled||P.navigator.msPointerEnabled,H=function(e){if($)return!0;if(!B||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},Q=!1!=!!(D.fullscreenEnabled||D.webkitFullscreenEnabled||D.mozFullScreenEnabled||D.msFullscreenEnabled);F.fn.imageLightbox=function(e){var c=F.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),a=function(){c.activity&&n(),c.arrows&&R.css("display","block")},t=function(){var e=D.location.search,t="imageLightboxIndex="+b,i="?"+t;if(e){var n=new RegExp("([?&])imageLightboxIndex=[^&]*");i=null!==e.match(n)?e.replace(n,"$1"+t):e+"&"+t}P.history.pushState({},"",i)},r=function(){if(--b<0){if(!0===c.quitOnEnd)return C(),!1;b=d.length-1}h=d.eq(b),t(),K.trigger("previous.ilb2"),S(1)},l=function(){if(++b>=d.length){if(!0===c.quitOnEnd)return C(),!1;b=0}t(),h=d.eq(b),K.trigger("next.ilb2"),S(-1)},i=function(){K.append(M)},n=function(){F(".imagelightbox-loading").remove()},o=function(){K.append(X)},u=function(){z.appendTo(K).on("click.ilb7",function(){return C(),!1})},s=function(){L.html("&nbsp;"),F(h).data("ilb2-caption")?L.html(F(h).data("ilb2-caption")):0<F(h).find("img").length&&L.html(F(h).find("img").attr("alt"))},g=function(){if(d.length){for(var e=0;e<d.length;e++)N.append(j.clone());var t=N.children("a");t.eq(d.index(h)).addClass("active"),K.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(d.index(h)).addClass("active")}),K.append(N),N.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=F(this);if(d.eq(e.index()).attr("href")!==F(".imagelightbox").attr("src")){var t=d.eq(e.index());t.length&&(E=d.index(h),h=t,S(e.index()<E?-1:1))}e.addClass("active").siblings().removeClass("active")})}},f=function(){K.append(R),R.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),F(this).hasClass("imagelightbox-arrow-left")?r():l(),!1})},p="",d=F([]),h=F(),b=0,m=F(),v=0,x=0,w=0,y=!1,E=0,q=function(e){return"a"===F(e).prop("tagName").toLowerCase()&&new RegExp(".("+c.allowedTypes+")$","i").test(F(e).attr("href"))},k=function(){if(!m.length)return!0;var e=c.caption?L.outerHeight():0,o=F(P).width(),a=F(P).height()-e,r=Math.abs(1-c.gutter/100),l=new Image;l.src=m.attr("src"),l.onload=function(){if(v=l.width,x=l.height,o<v||a<x){var e=o/a<v/x?v/o:x/a;v/=e,x/=e}var t=x*r,i=v*r,n=(F(P).width()-i)/2;m.css({width:i+"px",height:t+"px",left:n+"px"})}},S=function(o){if(y)return!1;if(m.length){var e={opacity:0};Y?_(m,100*o-w+"px",c.animationSpeed/1e3):e.left=parseInt(m.css("left"))+100*o+"px",m.animate(e,c.animationSpeed,function(){I()}),w=0}y=!0,c.activity&&i(),c.caption&&s(),setTimeout(function(){var e=h.attr("href");m=F("<img id='"+c.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(m.appendTo(K),k(),m.css("opacity",0),Y)_(m,-100*o+"px",0),setTimeout(function(){_(m,"0px",c.animationSpeed/1e3)},50);else{var t=parseInt(m.css("left"));e.left=t+"px",m.css("left",t-100*o+"px")}if(m.animate(e,c.animationSpeed,function(){y=!1,a()}),c.preloadNext){var i=d.eq(d.index(h)+1);i.length||(i=d.eq(0)),F("<img />").attr("src",i.attr("href"))}K.trigger("loaded.ilb2")}).on("error.ilb7",function(){a()});var t=0,i=0,n=0;m.on(B?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),c.quitOnImgClick?(C(),!1):!!H(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<v/2?r():l())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!H(e.originalEvent)||c.quitOnImgClick)return!0;Y&&(n=parseInt(m.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!B&&"pointermove"===e.type||!H(e.originalEvent)||c.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,w=t-i,Y?_(m,-w+"px",0):m.css("left",n-w+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!H(e.originalEvent)||c.quitOnImgClick)return!0;50<Math.abs(w)?w<0?r():l():Y?_(m,"0px",c.animationSpeed/1e3):m.animate({left:n+"px"},c.animationSpeed/2)})},c.animationSpeed+100)},I=function(){if(!m.length)return!1;m.remove(),m=F()},O=function(e){if(y)return!1;y=!1,h=e,b=d.index(h),t(),function(){c.arrows&&f(this),c.navigation&&g(),c.overlay&&o(),c.button&&u(),c.caption&&K.append(L)}(),U.append(K).addClass("imagelightbox-open"),K.trigger("start.ilb2"),S(0)},C=function(){if(function(){var e=D.location.search;if(e){var t=new RegExp("[?]imageLightboxIndex=[^&]*"),i=new RegExp("&imageLightboxIndex=[^&]*"),n=e.replace(t,"?");n=n.replace(i,""),P.history.pushState({},"",n)}}(),K.trigger("quit.ilb2"),U.removeClass("imagelightbox-open"),!m.length)return!1;m.animate({opacity:0},c.animationSpeed,function(){I(),y=!1,d=F([]),K.remove().find("*").remove()})},T=function(t){t.on("click.ilb7",{set:p},function(e){e.preventDefault(),p=F(e.currentTarget).data("imagelightbox"),t.filter(function(){return F(this).data("imagelightbox")===p}).filter(function(){return q(F(this))}).each(function(){d=d.add(F(this))}),d.length<1?C():O(F(this))})};return F(P).on("resize.ilb7",k),F(D).ready(function(){c.quitOnDocClick&&F(D).on($?"touchend.ilb7":"click.ilb7",function(e){m.length&&!F(e.target).is(m)&&(e.preventDefault(),C())}),c.fullscreen&&Q&&F(D).on("keydown.ilb7",function(e){if(!m.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=D.getElementById(c.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),D.exitFullscreen?D.exitFullscreen():D.mozCancelFullScreen?D.mozCancelFullScreen():D.webkitExitFullscreen&&D.webkitExitFullscreen())}),c.enableKeyboard&&F(D).on("keydown.ilb7",function(e){if(!m.length)return!0;-1<[27].indexOf(e.which)&&c.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),C()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),r()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),l())})}),F(D).off("click",c.selector),T(F(this)),this.addToImageLightbox=function(e){T(e)},this.loadPreviousImage=function(){r()},this.loadNextImage=function(){l()},this.quitImageLightbox=function(){return C(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):F(this).trigger("click.ilb7")},this}});