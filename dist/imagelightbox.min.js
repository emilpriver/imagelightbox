!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(D,M,z){"use strict";var X=D("<div/>").attr("class","imagelightbox-loading").append(D("<div/>")),e=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=D("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),j=e.add(t),N=D("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),U=D("<a/>",{class:"imagelightbox-close"}),K=D("<div/>",{class:"imagelightbox-overlay"}),Y=D("<a/>",{href:"#",class:"imagelightbox-navitem"}),_=D("<div/>",{class:"imagelightbox-nav"}),$=D("<div/>",{class:"imagelightbox-wrapper"}),B=D("body"),o=function(){var e=z.body||z.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},H=!1!==o(),Q=function(e,t,i){var n={},a=o();n[a+"transform"]="translateX("+t+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s linear",e.css(n)},W="ontouchstart"in M,A=M.navigator.pointerEnabled||M.navigator.msPointerEnabled,G=function(e){if(W)return!0;if(!A||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},J=!1!=!!(z.fullscreenEnabled||z.webkitFullscreenEnabled||z.mozFullScreenEnabled||z.msFullscreenEnabled),V=!(!M.history||!history.pushState);D.fn.imageLightbox=function(e){var i="",r=D([]),l=D(),c=-1,u=D(this),s=D(),g=0,f=0,o=0,p=!1,n=0,d=D.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),h=function(){d.activity&&w(),d.arrows&&j.css("display","block")},a=function(e,t,i){var n=t+"="+i,a="?"+n;if(e){var o=new RegExp("([?&])"+t+"=[^&]*");a=null!==e.match(o)?e.replace(o,"$1"+n):e+"&"+n}return a},b=function(){if(V&&d.history){var e=r[c].dataset.ilb2Id;e||(e=c);var t={imageLightboxIndex:e},i=r[c].dataset.imagelightbox;i&&(t.imageLightboxSet=i);var n=a(z.location.search,"imageLightboxIndex",e);i&&(n=a(n,"imageLightboxSet",i)),M.history.pushState(t,"",n)}},t=function(e,t){var i=e;if(i){var n=new RegExp("[?]"+t+"=[^&]*"),a=new RegExp("&"+t+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},m=function(e){var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(z.location.search);if(t&&t[2])return decodeURIComponent(t[2].replace(/\+/g," "))},v=function(){if(--c<0){if(!0===d.quitOnEnd)return L(),!1;c=r.length-1}l=r.eq(c),b(),$.trigger("previous.ilb2"),T(1)},x=function(){if(++c>=r.length){if(!0===d.quitOnEnd)return L(),!1;c=0}b(),l=r.eq(c),$.trigger("next.ilb2"),T(-1)},y=function(){$.append(X)},w=function(){D(".imagelightbox-loading").remove()},E=function(){$.append(K)},q=function(){U.appendTo($).on("click.ilb7",function(){return L(),!1})},S=function(){N.html("&nbsp;"),D(l).data("ilb2-caption")?N.html(D(l).data("ilb2-caption")):0<D(l).find("img").length&&N.html(D(l).find("img").attr("alt"))},k=function(){if(r.length){for(var e=0;e<r.length;e++)_.append(Y.clone());var t=_.children("a");t.eq(r.index(l)).addClass("active"),$.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(r.index(l)).addClass("active")}),$.append(_),_.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=D(this);if(r.eq(e.index()).attr("href")!==D(".imagelightbox").attr("src")){var t=r.eq(e.index());t.length&&(n=r.index(l),l=t,T(e.index()<n?-1:1))}e.addClass("active").siblings().removeClass("active")})}},I=function(){$.append(j),j.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),D(this).hasClass("imagelightbox-arrow-left")?v():x(),!1})},O=function(e){return"a"===D(e).prop("tagName").toLowerCase()&&new RegExp(".("+d.allowedTypes+")$","i").test(D(e).attr("href"))},C=function(){if(!s.length)return!0;var e=d.caption?N.outerHeight():0,a=D(M).width(),o=D(M).height()-e,r=Math.abs(1-d.gutter/100),l=new Image;l.src=s.attr("src"),l.onload=function(){if(g=l.width,f=l.height,a<g||o<f){var e=a/o<g/f?g/a:f/o;g/=e,f/=e}var t=f*r,i=g*r,n=(D(M).width()-i)/2;s.css({width:i+"px",height:t+"px",left:n+"px"})}},T=function(a){if(p)return!1;if(s.length){var e={opacity:0};H?Q(s,100*a-o+"px",d.animationSpeed/1e3):e.left=parseInt(s.css("left"))+100*a+"px",s.animate(e,d.animationSpeed,function(){F()}),o=0}p=!0,d.activity&&y(),d.caption&&S(),setTimeout(function(){var e=l.attr("href"),t=0,i=0,n=0;s=D("<img id='"+d.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(s.appendTo($),C(),s.css("opacity",0),H)Q(s,-100*a+"px",0),setTimeout(function(){Q(s,"0px",d.animationSpeed/1e3)},50);else{var t=parseInt(s.css("left"));e.left=t+"px",s.css("left",t-100*a+"px")}if(s.animate(e,d.animationSpeed,function(){p=!1,h()}),d.preloadNext){var i=r.eq(r.index(l)+1);i.length||(i=r.eq(0)),D("<img />").attr("src",i.attr("href"))}$.trigger("loaded.ilb2")}).on("error.ilb7",function(){h()}).on(A?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),d.quitOnImgClick?(L(),!1):!!G(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<g/2?v():x())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!G(e.originalEvent)||d.quitOnImgClick)return!0;H&&(n=parseInt(s.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!A&&"pointermove"===e.type||!G(e.originalEvent)||d.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,o=t-i,H?Q(s,-o+"px",0):s.css("left",n-o+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!G(e.originalEvent)||d.quitOnImgClick)return!0;50<Math.abs(o)?o<0?v():x():H?Q(s,"0px",d.animationSpeed/1e3):s.animate({left:n+"px"},d.animationSpeed/2)})},d.animationSpeed+100)},F=function(){if(!s.length)return!1;s.remove(),s=D()},P=function(e,t){if(p)return!1;p=!1,l=e,c=r.index(l),t||b(),function(){d.arrows&&I(this),d.navigation&&k(),d.overlay&&E(),d.button&&q(),d.caption&&$.append(N)}(),B.append($).addClass("imagelightbox-open"),$.trigger("start.ilb2"),T(0)},L=function(e){if(c=-1,e||function(){if(V&&d.history){var e=t(z.location.search,"imageLightboxIndex");e=t(e,"imageLightboxSet"),M.history.pushState({},"",e)}}(),$.trigger("quit.ilb2"),B.removeClass("imagelightbox-open"),!s.length)return!1;s.animate({opacity:0},d.animationSpeed,function(){F(),p=!1,r=D([]),$.remove().find("*").remove()})},R=function(t){t.on("click.ilb7",{set:i},function(e){e.preventDefault(),i=D(e.currentTarget).data("imagelightbox"),t.filter(function(){return D(this).data("imagelightbox")===i}).filter(function(){return O(D(this))}).each(function(){r=r.add(D(this))}),r.length<1?L():P(D(this))})};return D(M).on("resize.ilb7",C),V&&d.history&&D(M).on("popstate",function(e){var t=e.originalEvent.state;if(t){var i=t.imageLightboxIndex;if(void 0!==i){var n=u.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=u.index(n);else n=D(u[a=i]);if(c<0)return r=u,void P(n,!0);var o=1;c<a&&(o=-1),l=n,c=a,T(o)}else L(!0)}else L(!0)}),D(z).ready(function(){d.quitOnDocClick&&D(z).on(W?"touchend.ilb7":"click.ilb7",function(e){s.length&&!D(e.target).is(s)&&(e.preventDefault(),L())}),d.fullscreen&&J&&D(z).on("keydown.ilb7",function(e){if(!s.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=z.getElementById(d.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),z.exitFullscreen?z.exitFullscreen():z.mozCancelFullScreen?z.mozCancelFullScreen():z.webkitExitFullscreen&&z.webkitExitFullscreen())}),d.enableKeyboard&&D(z).on("keydown.ilb7",function(e){if(!s.length)return!0;-1<[27].indexOf(e.which)&&d.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),L()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),v()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),x())})}),D(z).off("click",d.selector),R(u),function(){if(V&&d.history){var e=m("imageLightboxIndex");if(e){var t=(r=u).filter('[data-ilb2-id="'+e+'"]');0<t.length?c=r.index(t):t=D(r[c=e]);var i=m("imageLightboxSet");i&&i!==t[0].dataset.imagelightbox||P(t,!0)}}}(),this.addToImageLightbox=function(e){R(e)},this.loadPreviousImage=function(){v()},this.loadNextImage=function(){x()},this.quitImageLightbox=function(){return L(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):D(this).trigger("click.ilb7")},this}});