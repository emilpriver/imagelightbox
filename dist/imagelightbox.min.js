!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(R,D,M){"use strict";var L=R("<div/>").attr("class","imagelightbox-loading").append(R("<div/>")),e=R("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),t=R("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),z=e.add(t),X=R("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),j=R("<a/>",{class:"imagelightbox-close"}),N=R("<div/>",{class:"imagelightbox-overlay"}),U=R("<a/>",{href:"#",class:"imagelightbox-navitem"}),K=R("<div/>",{class:"imagelightbox-nav"}),Y=R("<div/>",{class:"imagelightbox-wrapper"}),_=R("body"),a=function(){var e=M.body||M.documentElement;return""===(e=e.style).WebkitTransition?"-webkit-":""===e.MozTransition?"-moz-":""===e.OTransition?"-o-":""===e.transition&&""},$=!1!==a(),B=function(e,t,i){var n={},o=a();n[o+"transform"]="translateX("+t+") translateY(-50%)",n[o+"transition"]=o+"transform "+i+"s linear",e.css(n)},H="ontouchstart"in D,Q=D.navigator.pointerEnabled||D.navigator.msPointerEnabled,W=function(e){if(H)return!0;if(!Q||void 0===e||void 0===e.pointerType)return!1;if(void 0!==e.MSPOINTER_TYPE_MOUSE){if(e.MSPOINTER_TYPE_MOUSE!==e.pointerType)return!0}else if("mouse"!==e.pointerType)return!0;return!1},A=!1!=!!(M.fullscreenEnabled||M.webkitFullscreenEnabled||M.mozFullScreenEnabled||M.msFullscreenEnabled);R.fn.imageLightbox=function(e){var t,i,c=R.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},e),a=function(){c.activity&&o(),c.arrows&&z.css("display","block")},n=function(){var e=M.location.search,t="imageLightboxIndex="+v,i="?"+t;if(e){var n=new RegExp("([?&])imageLightboxIndex=[^&]*");i=null!==e.match(n)?e.replace(n,"$1"+t):e+"&"+t}D.history.pushState({},"",i)},r=function(){if(--v<0){if(!0===c.quitOnEnd)return F(),!1;v=b.length-1}m=b.eq(v),n(),Y.trigger("previous.ilb2"),O(1)},l=function(){if(++v>=b.length){if(!0===c.quitOnEnd)return F(),!1;v=0}n(),m=b.eq(v),Y.trigger("next.ilb2"),O(-1)},u=function(){Y.append(L)},o=function(){R(".imagelightbox-loading").remove()},s=function(){Y.append(N)},g=function(){j.appendTo(Y).on("click.ilb7",function(){return F(),!1})},p=function(){X.html("&nbsp;"),R(m).data("ilb2-caption")?X.html(R(m).data("ilb2-caption")):0<R(m).find("img").length&&X.html(R(m).find("img").attr("alt"))},f=function(){if(b.length){for(var e=0;e<b.length;e++)K.append(U.clone());var t=K.children("a");t.eq(b.index(m)).addClass("active"),Y.on("previous.ilb2 next.ilb2",function(){t.removeClass("active").eq(b.index(m)).addClass("active")}),Y.append(K),K.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var e=R(this);if(b.eq(e.index()).attr("href")!==R(".imagelightbox").attr("src")){var t=b.eq(e.index());t.length&&(k=b.index(m),m=t,O(e.index()<k?-1:1))}e.addClass("active").siblings().removeClass("active")})}},d=function(){Y.append(z),z.on("click.ilb7 touchend.ilb7",function(e){return e.stopImmediatePropagation(),e.preventDefault(),R(this).hasClass("imagelightbox-arrow-left")?r():l(),!1})},h="",b=R([]),m=R(),v=0,x=R(),w=0,y=0,E=0,q=!1,k=0,S=function(e){return"a"===R(e).prop("tagName").toLowerCase()&&new RegExp(".("+c.allowedTypes+")$","i").test(R(e).attr("href"))},I=function(){if(!x.length)return!0;var e=c.caption?X.outerHeight():0,o=R(D).width(),a=R(D).height()-e,r=Math.abs(1-c.gutter/100),l=new Image;l.src=x.attr("src"),l.onload=function(){if(w=l.width,y=l.height,o<w||a<y){var e=o/a<w/y?w/o:y/a;w/=e,y/=e}var t=y*r,i=w*r,n=(R(D).width()-i)/2;x.css({width:i+"px",height:t+"px",left:n+"px"})}},O=function(o){if(q)return!1;if(x.length){var e={opacity:0};$?B(x,100*o-E+"px",c.animationSpeed/1e3):e.left=parseInt(x.css("left"))+100*o+"px",x.animate(e,c.animationSpeed,function(){C()}),E=0}q=!0,c.activity&&u(),c.caption&&p(),setTimeout(function(){var e=m.attr("href");x=R("<img id='"+c.id+"' />").attr("src",e).on("load.ilb7",function(){var e={opacity:1};if(x.appendTo(Y),I(),x.css("opacity",0),$)B(x,-100*o+"px",0),setTimeout(function(){B(x,"0px",c.animationSpeed/1e3)},50);else{var t=parseInt(x.css("left"));e.left=t+"px",x.css("left",t-100*o+"px")}if(x.animate(e,c.animationSpeed,function(){q=!1,a()}),c.preloadNext){var i=b.eq(b.index(m)+1);i.length||(i=b.eq(0)),R("<img />").attr("src",i.attr("href"))}Y.trigger("loaded.ilb2")}).on("error.ilb7",function(){a()});var t=0,i=0,n=0;x.on(Q?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(e){return e.preventDefault(),c.quitOnImgClick?(F(),!1):!!W(e.originalEvent)||void((e.pageX||e.originalEvent.pageX)-e.target.offsetLeft<w/2?r():l())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(e){if(!W(e.originalEvent)||c.quitOnImgClick)return!0;$&&(n=parseInt(x.css("left"))),t=e.originalEvent.pageX||e.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(e){if(!Q&&"pointermove"===e.type||!W(e.originalEvent)||c.quitOnImgClick)return!0;e.preventDefault(),i=e.originalEvent.pageX||e.originalEvent.touches[0].pageX,E=t-i,$?B(x,-E+"px",0):x.css("left",n-E+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(e){if(!W(e.originalEvent)||c.quitOnImgClick)return!0;50<Math.abs(E)?E<0?r():l():$?B(x,"0px",c.animationSpeed/1e3):x.animate({left:n+"px"},c.animationSpeed/2)})},c.animationSpeed+100)},C=function(){if(!x.length)return!1;x.remove(),x=R()},T=function(e){if(q)return!1;q=!1,m=e,v=b.index(m),n(),function(){c.arrows&&d(this),c.navigation&&f(),c.overlay&&s(),c.button&&g(),c.caption&&Y.append(X)}(),_.append(Y).addClass("imagelightbox-open"),Y.trigger("start.ilb2"),O(0)},F=function(){if(function(){var e=M.location.search;if(e){var t=new RegExp("[?]imageLightboxIndex=[^&]*"),i=new RegExp("&imageLightboxIndex=[^&]*"),n=e.replace(t,"?");n=n.replace(i,""),D.history.pushState({},"",n)}}(),Y.trigger("quit.ilb2"),_.removeClass("imagelightbox-open"),!x.length)return!1;x.animate({opacity:0},c.animationSpeed,function(){C(),q=!1,b=R([]),Y.remove().find("*").remove()})},P=function(t){t.on("click.ilb7",{set:h},function(e){e.preventDefault(),h=R(e.currentTarget).data("imagelightbox"),t.filter(function(){return R(this).data("imagelightbox")===h}).filter(function(){return S(R(this))}).each(function(){b=b.add(R(this))}),b.length<1?F():T(R(this))})};return R(D).on("resize.ilb7",I),R(M).ready(function(){c.quitOnDocClick&&R(M).on(H?"touchend.ilb7":"click.ilb7",function(e){x.length&&!R(e.target).is(x)&&(e.preventDefault(),F())}),c.fullscreen&&A&&R(M).on("keydown.ilb7",function(e){if(!x.length)return!0;var t;-1<[9,32,38,40].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault()),-1<[13].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),(t=M.getElementById(c.id).parentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),M.exitFullscreen?M.exitFullscreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen&&M.webkitExitFullscreen())}),c.enableKeyboard&&R(M).on("keydown.ilb7",function(e){if(!x.length)return!0;-1<[27].indexOf(e.which)&&c.quitOnEscKey&&(e.stopPropagation(),e.preventDefault(),F()),-1<[37].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),r()),-1<[39].indexOf(e.which)&&(e.stopPropagation(),e.preventDefault(),l())})}),R(M).off("click",c.selector),P(R(this)),t=R(this),(i=new RegExp("[?&]imageLightboxIndex(=([^&#]*)|&|#|$)").exec(M.location.search))&&i[2]&&(v=decodeURIComponent(i[2].replace(/\+/g," ")),T(R((b=t)[v]))),this.addToImageLightbox=function(e){P(e)},this.loadPreviousImage=function(){r()},this.loadNextImage=function(){l()},this.quitImageLightbox=function(){return F(),this},this.startImageLightbox=function(e){e?e.trigger("click.ilb7"):R(this).trigger("click.ilb7")},this}});